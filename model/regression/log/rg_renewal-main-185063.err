2025-04-29 02:47:47,863 [INFO] Successfully imported model classes using relative paths.
2025-04-29 02:47:49,700 [INFO] Successfully imported utils using relative paths.
2025-04-29 02:47:49,704 [INFO] Using 40 CPU cores.
2025-04-29 02:47:49,705 [INFO] Results will be saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_renewal_test_20250429_024702
2025-04-29 02:47:49,739 [INFO] 
--- Loading Data ---
2025-04-29 02:47:49,846 [INFO] Data Loading & Preprocessing Duration: 0.11 seconds
2025-04-29 02:47:49,846 [INFO] 
--- Starting Model Training ---
2025-04-29 02:47:49,849 [INFO] 
=== Processing model: Random Forest (rf) ===
2025-04-29 02:47:49,851 [INFO] 
--- Running Nested CV for Regression: Random Forest (rf) ---
2025-04-29 02:47:49,851 [INFO] Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_renewal_test_20250429_024702/rf
2025-04-29 02:47:49,851 [INFO] Hyperparameter tuning scoring metric: neg_mean_squared_error
2025-04-29 02:47:49,851 [INFO] Using GroupKFold for outer CV with 5 folds based on query IDs.
2025-04-29 02:47:49,855 [INFO] 
-- Processing Outer Fold 1/5 --
2025-04-29 02:47:49,858 [INFO] Train set size: (2898, 63), Test set size: (749, 63)
2025-04-29 02:47:49,858 [INFO] Test set indices range from 650 to 3546
2025-04-29 02:47:49,858 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:47:49,858 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:47:49,860 [INFO] Tree-based model 'rf'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:47:49,860 [INFO] Fitting with groups parameter for GroupKFold
2025-04-29 02:50:02,243 [INFO] Best Params found: {'bootstrap': True, 'max_depth': 20, 'max_features': 'log2', 'min_samples_leaf': 10, 'min_samples_split': 8, 'n_estimators': 177}
2025-04-29 02:50:02,265 [INFO] Best Inner CV Score (neg_mean_squared_error): -0.0286
2025-04-29 02:50:02,376 [INFO] Hyperparameter Tuning Duration: 132.52 seconds
2025-04-29 02:50:02,376 [INFO] Predicting on outer test set...
2025-04-29 02:50:02,463 [INFO] Calculating performance metrics...
2025-04-29 02:50:02,672 [INFO] Generating diagnostic plots...
2025-04-29 02:50:05,208 [INFO] Diagnostic plots saved.
2025-04-29 02:50:05,208 [INFO] Prediction & Evaluation Duration: 2.83 seconds
2025-04-29 02:50:05,208 [INFO] Calculating and saving SHAP values...
2025-04-29 02:50:05,208 [INFO] Sampling 100 instances from X_train for SHAP background data.
2025-04-29 02:50:12,184 [INFO] SHAP Calculation & Saving Duration: 6.98 seconds
2025-04-29 02:50:12,184 [INFO] -- Outer Fold 1 finished. Duration: 142.33 seconds --
2025-04-29 02:50:12,184 [INFO] 
-- Processing Outer Fold 2/5 --
2025-04-29 02:50:12,204 [INFO] Train set size: (2898, 63), Test set size: (749, 63)
2025-04-29 02:50:12,204 [INFO] Test set indices range from 150 to 3097
2025-04-29 02:50:12,204 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:50:12,204 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:50:12,207 [INFO] Tree-based model 'rf'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:50:12,208 [INFO] Fitting with groups parameter for GroupKFold
2025-04-29 02:52:19,846 [INFO] Best Params found: {'bootstrap': True, 'max_depth': 20, 'max_features': 'log2', 'min_samples_leaf': 10, 'min_samples_split': 8, 'n_estimators': 177}
2025-04-29 02:52:19,847 [INFO] Best Inner CV Score (neg_mean_squared_error): -0.0225
2025-04-29 02:52:19,875 [INFO] Hyperparameter Tuning Duration: 127.67 seconds
2025-04-29 02:52:19,875 [INFO] Predicting on outer test set...
2025-04-29 02:52:19,961 [INFO] Calculating performance metrics...
2025-04-29 02:52:20,206 [INFO] Generating diagnostic plots...
2025-04-29 02:52:20,977 [INFO] Diagnostic plots saved.
2025-04-29 02:52:20,977 [INFO] Prediction & Evaluation Duration: 1.10 seconds
2025-04-29 02:52:20,977 [INFO] Calculating and saving SHAP values...
2025-04-29 02:52:20,977 [INFO] Sampling 100 instances from X_train for SHAP background data.
2025-04-29 02:52:28,746 [INFO] SHAP Calculation & Saving Duration: 7.77 seconds
2025-04-29 02:52:28,772 [INFO] -- Outer Fold 2 finished. Duration: 136.59 seconds --
2025-04-29 02:52:28,772 [INFO] 
-- Processing Outer Fold 3/5 --
2025-04-29 02:52:28,840 [INFO] Train set size: (2898, 63), Test set size: (749, 63)
2025-04-29 02:52:28,840 [INFO] Test set indices range from 50 to 3147
2025-04-29 02:52:28,841 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:52:28,841 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:52:28,843 [INFO] Tree-based model 'rf'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:52:28,844 [INFO] Fitting with groups parameter for GroupKFold
2025-04-29 02:54:41,452 [INFO] Best Params found: {'bootstrap': True, 'max_depth': 20, 'max_features': 'log2', 'min_samples_leaf': 10, 'min_samples_split': 8, 'n_estimators': 177}
2025-04-29 02:54:41,453 [INFO] Best Inner CV Score (neg_mean_squared_error): -0.0214
2025-04-29 02:54:41,502 [INFO] Hyperparameter Tuning Duration: 132.66 seconds
2025-04-29 02:54:41,502 [INFO] Predicting on outer test set...
2025-04-29 02:54:41,589 [INFO] Calculating performance metrics...
2025-04-29 02:54:41,740 [INFO] Generating diagnostic plots...
2025-04-29 02:54:42,698 [INFO] Diagnostic plots saved.
2025-04-29 02:54:42,698 [INFO] Prediction & Evaluation Duration: 1.20 seconds
2025-04-29 02:54:42,698 [INFO] Calculating and saving SHAP values...
2025-04-29 02:54:42,698 [INFO] Sampling 100 instances from X_train for SHAP background data.
2025-04-29 02:54:51,749 [INFO] SHAP Calculation & Saving Duration: 9.05 seconds
2025-04-29 02:54:51,751 [INFO] -- Outer Fold 3 finished. Duration: 142.98 seconds --
2025-04-29 02:54:51,751 [INFO] 
-- Processing Outer Fold 4/5 --
2025-04-29 02:54:51,763 [INFO] Train set size: (2947, 63), Test set size: (700, 63)
2025-04-29 02:54:51,825 [INFO] Test set indices range from 250 to 3646
2025-04-29 02:54:51,825 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:54:51,826 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:54:51,828 [INFO] Tree-based model 'rf'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:54:51,830 [INFO] Fitting with groups parameter for GroupKFold
2025-04-29 02:57:01,968 [INFO] Best Params found: {'bootstrap': True, 'max_depth': None, 'max_features': 'log2', 'min_samples_leaf': 7, 'min_samples_split': 10, 'n_estimators': 127}
2025-04-29 02:57:01,969 [INFO] Best Inner CV Score (neg_mean_squared_error): -0.0214
2025-04-29 02:57:02,035 [INFO] Hyperparameter Tuning Duration: 130.21 seconds
2025-04-29 02:57:02,035 [INFO] Predicting on outer test set...
2025-04-29 02:57:02,100 [INFO] Calculating performance metrics...
2025-04-29 02:57:02,167 [INFO] Generating diagnostic plots...
2025-04-29 02:57:03,026 [INFO] Diagnostic plots saved.
2025-04-29 02:57:03,026 [INFO] Prediction & Evaluation Duration: 0.99 seconds
2025-04-29 02:57:03,026 [INFO] Calculating and saving SHAP values...
2025-04-29 02:57:03,027 [INFO] Sampling 100 instances from X_train for SHAP background data.
2025-04-29 02:57:17,139 [INFO] SHAP Calculation & Saving Duration: 14.11 seconds
2025-04-29 02:57:17,139 [INFO] -- Outer Fold 4 finished. Duration: 145.39 seconds --
2025-04-29 02:57:17,139 [INFO] 
-- Processing Outer Fold 5/5 --
2025-04-29 02:57:17,141 [INFO] Train set size: (2947, 63), Test set size: (700, 63)
2025-04-29 02:57:17,141 [INFO] Test set indices range from 0 to 3596
2025-04-29 02:57:17,141 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:57:17,141 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:57:17,142 [INFO] Tree-based model 'rf'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:57:17,143 [INFO] Fitting with groups parameter for GroupKFold
2025-04-29 02:59:26,298 [INFO] Best Params found: {'bootstrap': False, 'max_depth': 20, 'max_features': 'log2', 'min_samples_leaf': 9, 'min_samples_split': 6, 'n_estimators': 105}
2025-04-29 02:59:26,308 [INFO] Best Inner CV Score (neg_mean_squared_error): -0.0289
2025-04-29 02:59:26,399 [INFO] Hyperparameter Tuning Duration: 129.26 seconds
2025-04-29 02:59:26,399 [INFO] Predicting on outer test set...
2025-04-29 02:59:26,453 [INFO] Calculating performance metrics...
2025-04-29 02:59:26,991 [INFO] Generating diagnostic plots...
2025-04-29 02:59:27,685 [INFO] Diagnostic plots saved.
2025-04-29 02:59:27,685 [INFO] Prediction & Evaluation Duration: 1.29 seconds
2025-04-29 02:59:27,685 [INFO] Calculating and saving SHAP values...
2025-04-29 02:59:27,685 [INFO] Sampling 100 instances from X_train for SHAP background data.
2025-04-29 02:59:35,877 [INFO] SHAP Calculation & Saving Duration: 8.19 seconds
2025-04-29 02:59:35,877 [INFO] -- Outer Fold 5 finished. Duration: 138.74 seconds --
2025-04-29 02:59:35,877 [INFO] 
--- Aggregating results for: Random Forest (rf) ---
2025-04-29 02:59:35,878 [INFO] Average Metrics across folds:
2025-04-29 02:59:35,878 [INFO] {
    "r2_mean": 0.684690831541755,
    "r2_std": 0.2192443374018038,
    "mse_mean": 0.024808330935463314,
    "mse_std": 0.012959167262530338,
    "rmse_mean": 0.15224980921438977,
    "rmse_std": 0.040352528169189404,
    "mae_mean": 0.09617480526805736,
    "mae_std": 0.02997425738148471,
    "best_inner_cv_score_mean": -0.02453585082005555,
    "best_inner_cv_score_std": 0.003452348223068885,
    "scoring_metric_used": "neg_mean_squared_error"
}
2025-04-29 02:59:35,947 [INFO] Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_renewal_test_20250429_024702/rf/all_folds_predictions.csv
2025-04-29 02:59:35,947 [INFO] 
Running global SHAP analysis...
2025-04-29 02:59:37,437 [INFO] Global SHAP Analysis Duration: 1.49 seconds
2025-04-29 02:59:37,437 [INFO] Result Aggregation & Global SHAP Duration: 1.56 seconds
2025-04-29 02:59:37,437 [INFO] Average time per outer fold: 141.20 seconds
2025-04-29 02:59:37,437 [INFO] --- Nested CV completed for: Random Forest (rf) ---
2025-04-29 02:59:37,438 [INFO] Total execution time for model 'rf': 707.59 seconds
2025-04-29 02:59:37,438 [INFO] 
=== Processing model: LightGBM (lgbm) ===
2025-04-29 02:59:37,442 [INFO] 
--- Running Nested CV for Regression: LightGBM (lgbm) ---
2025-04-29 02:59:37,442 [INFO] Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_renewal_test_20250429_024702/lgbm
2025-04-29 02:59:37,442 [INFO] Hyperparameter tuning scoring metric: neg_mean_squared_error
2025-04-29 02:59:37,442 [INFO] Using GroupKFold for outer CV with 5 folds based on query IDs.
2025-04-29 02:59:37,443 [INFO] 
-- Processing Outer Fold 1/5 --
2025-04-29 02:59:37,447 [INFO] Train set size: (2898, 63), Test set size: (749, 63)
2025-04-29 02:59:37,447 [INFO] Test set indices range from 650 to 3546
2025-04-29 02:59:37,448 [INFO] Using GroupKFold for inner CV with 3 folds.
2025-04-29 02:59:37,448 [INFO] Starting hyperparameter tuning (RandomizedSearchCV)...
2025-04-29 02:59:37,452 [INFO] Tree-based model 'lgbm'. Setting n_jobs=4 for hyperparameter tuning.
2025-04-29 02:59:37,452 [INFO] Fitting with groups parameter for GroupKFold
slurmstepd-gpu10: error: *** JOB 185063 ON gpu10 CANCELLED AT 2025-04-29T03:37:51 ***
