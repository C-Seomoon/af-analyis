=============================================
[INFO] Job Information
---------------------------------------------
[INFO] Job Name       : rg_framework_main
[INFO] Job ID         : 182220
[INFO] Submit Dir     : /home/cseomoon/appl/af_analysis-0.1.4/model/regression/scripts
[INFO] Partition      : a5000_short
[INFO] Node List      : gpu2
[INFO] Nodes          : 1
[INFO] CPUs per Task  : 32
[INFO] Memory (MB)    : 
[INFO] User           : cseomoon
[INFO] Work Dir       : /home/cseomoon/appl/af_analysis-0.1.4/model/regression/scripts
[INFO] Tasks per Node : 1
[INFO] Dependency     : 
[INFO] GPU(s)         : 
=============================================

[INFO] Job started at : Fri Apr 25 21:51:56 KST 2025
[INFO] Job allocated on node(s): gpu2
[INFO] Job running on: gpu2
[INFO] Saving results to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156
Successfully imported BaseModelRegressor using relative path '.' in linear_models.
Successfully imported model classes using relative paths.
Successfully imported utils using relative paths.
Initialized Random Forest (rf) with params: {'bootstrap': True, 'ccp_alpha': 0.0, 'criterion': 'squared_error', 'max_depth': None, 'max_features': 1.0, 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'n_estimators': 100, 'n_jobs': -1, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}
Initialized LightGBM (lgbm) with params: {'boosting_type': 'gbdt', 'class_weight': None, 'colsample_bytree': 0.8, 'importance_type': 'split', 'learning_rate': 0.1, 'max_depth': -1, 'min_child_samples': 20, 'min_child_weight': 0.001, 'min_split_gain': 0.0, 'n_estimators': 100, 'n_jobs': -1, 'num_leaves': 31, 'objective': 'regression_l1', 'random_state': 42, 'reg_alpha': 0.0, 'reg_lambda': 0.0, 'subsample': 0.8, 'subsample_for_bin': 200000, 'subsample_freq': 0, 'metric': 'mae', 'verbose': -1}
Initialized XGBoost (xgb) with params: {'objective': 'reg:squarederror', 'base_score': None, 'booster': None, 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.8, 'device': None, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'rmse', 'feature_types': None, 'feature_weights': None, 'gamma': 0, 'grow_policy': None, 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.1, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 3, 'max_leaves': None, 'min_child_weight': None, 'missing': nan, 'monotone_constraints': None, 'multi_strategy': None, 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': 0, 'reg_lambda': 1, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': 0.8, 'tree_method': 'hist', 'validate_parameters': None, 'verbosity': None}
Initialized Linear Regression pipeline (scale=True).
Initialized Ridge Regression pipeline (scale=True, alpha=1.0).
Initialized Lasso Regression pipeline (scale=True, alpha=1.0).
Initialized Elastic Net pipeline (scale=True, alpha=1.0, l1_ratio=0.5).
Using 32 CPU cores.
Results will be saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/run_arguments.json

--- Loading Data ---
Original data shape: (3650, 81)
Using 'DockQ' as the continuous target variable.
Identified 63 potential feature columns.
Checking for NaN values in potential feature columns...
Dropped 3 rows containing NaN values in one or more feature columns.
Generated 10 stratification bins from target for regression.
Processed Features (X) shape after NaN drop: (3647, 63)
Processed Target (y) shape after NaN drop: (3647,)
Processed Query IDs shape after NaN drop: (3647,)
Data Loading & Preprocessing Duration: 0.06 seconds

--- Starting Model Training ---
Initialized Random Forest (rf) with params: {'bootstrap': True, 'ccp_alpha': 0.0, 'criterion': 'squared_error', 'max_depth': None, 'max_features': 1.0, 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'n_estimators': 100, 'n_jobs': -1, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}
Initialized LightGBM (lgbm) with params: {'boosting_type': 'gbdt', 'class_weight': None, 'colsample_bytree': 0.8, 'importance_type': 'split', 'learning_rate': 0.1, 'max_depth': -1, 'min_child_samples': 20, 'min_child_weight': 0.001, 'min_split_gain': 0.0, 'n_estimators': 100, 'n_jobs': -1, 'num_leaves': 31, 'objective': 'regression_l1', 'random_state': 42, 'reg_alpha': 0.0, 'reg_lambda': 0.0, 'subsample': 0.8, 'subsample_for_bin': 200000, 'subsample_freq': 0, 'metric': 'mae', 'verbose': -1}
Initialized XGBoost (xgb) with params: {'objective': 'reg:squarederror', 'base_score': None, 'booster': None, 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.8, 'device': None, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'rmse', 'feature_types': None, 'feature_weights': None, 'gamma': 0, 'grow_policy': None, 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.1, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 3, 'max_leaves': None, 'min_child_weight': None, 'missing': nan, 'monotone_constraints': None, 'multi_strategy': None, 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': 0, 'reg_lambda': 1, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': 0.8, 'tree_method': 'hist', 'validate_parameters': None, 'verbosity': None}
Initialized Linear Regression pipeline (scale=True).
Initialized Ridge Regression pipeline (scale=True, alpha=1.0).
Initialized Lasso Regression pipeline (scale=True, alpha=1.0).
Initialized Elastic Net pipeline (scale=True, alpha=1.0, l1_ratio=0.5).

--- Running Nested CV for Regression: Random Forest (rf) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'bootstrap': False, 'max_depth': 20, 'max_features': 'sqrt', 'min_samples_leaf': 2, 'min_samples_split': 4, 'n_estimators': 341}
Best Inner CV Score (neg_mean_squared_error): -0.0184
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/best_params.json
Hyperparameter Tuning Duration: 78.69 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5831, RMSE=0.2051, MAE=0.1242
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.22 seconds
Calculating and saving SHAP values...
Calculating SHAP values for Random Forest using SHAP Explainer...
SHAP calculation took 203.33 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 211.92 seconds
-- Outer Fold 1 finished. Duration: 291.83 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'bootstrap': True, 'max_depth': 30, 'max_features': 'log2', 'min_samples_leaf': 9, 'min_samples_split': 7, 'n_estimators': 157}
Best Inner CV Score (neg_mean_squared_error): -0.0204
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/best_params.json
Hyperparameter Tuning Duration: 70.41 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8602, RMSE=0.1275, MAE=0.0865
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.93 seconds
Calculating and saving SHAP values...
Calculating SHAP values for Random Forest using SHAP Explainer...
SHAP calculation took 8.07 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 10.57 seconds
-- Outer Fold 2 finished. Duration: 81.92 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'bootstrap': False, 'max_depth': None, 'max_features': 'sqrt', 'min_samples_leaf': 6, 'min_samples_split': 8, 'n_estimators': 269}
Best Inner CV Score (neg_mean_squared_error): -0.0239
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/best_params.json
Hyperparameter Tuning Duration: 72.54 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7134, RMSE=0.1360, MAE=0.0934
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.22 seconds
Calculating and saving SHAP values...
Calculating SHAP values for Random Forest using SHAP Explainer...
SHAP calculation took 46.13 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 47.79 seconds
-- Outer Fold 3 finished. Duration: 121.56 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'bootstrap': False, 'max_depth': 30, 'max_features': 'log2', 'min_samples_leaf': 6, 'min_samples_split': 3, 'n_estimators': 291}
Best Inner CV Score (neg_mean_squared_error): -0.0243
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/best_params.json
Hyperparameter Tuning Duration: 72.84 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.3431, RMSE=0.1958, MAE=0.1124
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.10 seconds
Calculating and saving SHAP values...
Calculating SHAP values for Random Forest using SHAP Explainer...
SHAP calculation took 44.68 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 46.13 seconds
-- Outer Fold 4 finished. Duration: 120.08 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'bootstrap': False, 'max_depth': None, 'max_features': 'log2', 'min_samples_leaf': 8, 'min_samples_split': 5, 'n_estimators': 101}
Best Inner CV Score (neg_mean_squared_error): -0.0267
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/best_params.json
Hyperparameter Tuning Duration: 70.84 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8377, RMSE=0.1319, MAE=0.0773
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.97 seconds
Calculating and saving SHAP values...
Calculating SHAP values for Random Forest using SHAP Explainer...
SHAP calculation took 10.24 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 11.62 seconds
-- Outer Fold 5 finished. Duration: 83.51 seconds --

--- Aggregating results for: Random Forest (rf) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": 0.6674919785993039,
    "r2_std": 0.1900337578627834,
    "mse_mean": 0.026522270775093088,
    "mse_std": 0.011265194902951742,
    "rmse_mean": 0.15929652679639855,
    "rmse_std": 0.033865724939787914,
    "mae_mean": 0.09874821783318419,
    "mae_std": 0.01716448603712263,
    "best_inner_cv_score_mean": -0.02275342979434993,
    "best_inner_cv_score_std": 0.0029705158366191277,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: rf ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
                 feature  mean_abs_shap
0     chain_pair_iptm_AL       0.021997
1                 iptm_A       0.017627
2                 iptm_H       0.015585
3                 iptm_L       0.014576
4        avg_model_plddt       0.014130
5  chain_pair_pae_min_AH       0.014106
6     chain_pair_iptm_AH       0.012707
7      avg_interface_pae       0.011118
8     interface_plddt_AH       0.010660
9       interface_pae_AH       0.009638
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/rf/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: rf ---
Global SHAP Analysis Duration: 2.55 seconds
Result Aggregation & Global SHAP Duration: 2.74 seconds
Average time per outer fold: 139.78 seconds
--- Nested CV completed for: Random Forest (rf) ---
Total execution time for model 'rf': 701.64 seconds

--- Running Nested CV for Regression: LightGBM (lgbm) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.6488152939379115, 'learning_rate': 0.10903538202225403, 'max_depth': 20, 'min_child_samples': 12, 'n_estimators': 305, 'num_leaves': 36, 'reg_alpha': 0.2587799816000169, 'reg_lambda': 0.662522284353982, 'subsample': 0.7246844304357644}
Best Inner CV Score (neg_mean_squared_error): -0.0170
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/best_params.json
Hyperparameter Tuning Duration: 2990.55 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5886, RMSE=0.2038, MAE=0.1201
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.16 seconds
Calculating and saving SHAP values...
Calculating SHAP values for LightGBM using SHAP Explainer...
SHAP calculation took 0.46 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 1.58 seconds
-- Outer Fold 1 finished. Duration: 2993.29 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.8137309894122253, 'learning_rate': 0.10931223813661554, 'max_depth': -1, 'min_child_samples': 31, 'n_estimators': 496, 'num_leaves': 38, 'reg_alpha': 0.3892016787341631, 'reg_lambda': 0.01083765148029836, 'subsample': 0.9621527905677054}
Best Inner CV Score (neg_mean_squared_error): -0.0202
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/best_params.json
Hyperparameter Tuning Duration: 2365.61 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8608, RMSE=0.1273, MAE=0.0761
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.96 seconds
Calculating and saving SHAP values...
Calculating SHAP values for LightGBM using SHAP Explainer...
SHAP calculation took 0.80 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 2.43 seconds
-- Outer Fold 2 finished. Duration: 2369.01 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.6835674870461441, 'learning_rate': 0.14422870336481014, 'max_depth': 20, 'min_child_samples': 11, 'n_estimators': 738, 'num_leaves': 46, 'reg_alpha': 0.29529058841893874, 'reg_lambda': 0.3225507642386005, 'subsample': 0.9394679179698697}
Best Inner CV Score (neg_mean_squared_error): -0.0239
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/best_params.json
Hyperparameter Tuning Duration: 2853.67 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5988, RMSE=0.1609, MAE=0.0997
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.00 seconds
Calculating and saving SHAP values...
Calculating SHAP values for LightGBM using SHAP Explainer...
SHAP calculation took 1.40 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 3.75 seconds
-- Outer Fold 3 finished. Duration: 2858.44 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.7817071888876399, 'learning_rate': 0.11972062358763064, 'max_depth': 10, 'min_child_samples': 21, 'n_estimators': 997, 'num_leaves': 32, 'reg_alpha': 0.6845715478798333, 'reg_lambda': 0.08786811124265681, 'subsample': 0.6555299093768081}
Best Inner CV Score (neg_mean_squared_error): -0.0218
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/best_params.json
Hyperparameter Tuning Duration: 2750.95 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.0695, RMSE=0.2331, MAE=0.1255
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.10 seconds
Calculating and saving SHAP values...
Calculating SHAP values for LightGBM using SHAP Explainer...
SHAP calculation took 0.93 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 2.44 seconds
-- Outer Fold 4 finished. Duration: 2754.51 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.6048617898759265, 'learning_rate': 0.20397576534152784, 'max_depth': -1, 'min_child_samples': 24, 'n_estimators': 248, 'num_leaves': 35, 'reg_alpha': 0.5277011090862999, 'reg_lambda': 0.9929647961193003, 'subsample': 0.6295186258941595}
Best Inner CV Score (neg_mean_squared_error): -0.0270
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/best_params.json
Hyperparameter Tuning Duration: 3300.51 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8488, RMSE=0.1273, MAE=0.0778
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.84 seconds
Calculating and saving SHAP values...
Calculating SHAP values for LightGBM using SHAP Explainer...
SHAP calculation took 0.27 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 1.58 seconds
-- Outer Fold 5 finished. Duration: 3302.95 seconds --

--- Aggregating results for: LightGBM (lgbm) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": 0.593307835762881,
    "r2_std": 0.28681734038011397,
    "mse_mean": 0.03083211035242033,
    "mse_std": 0.014957483390000293,
    "rmse_mean": 0.17047689400542348,
    "rmse_std": 0.042068265506007285,
    "mae_mean": 0.09984874115820555,
    "mae_std": 0.020601319222997606,
    "best_inner_cv_score_mean": -0.021994170051649962,
    "best_inner_cv_score_std": 0.0033731533551209707,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: lgbm ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
                 feature  mean_abs_shap
0     chain_pair_iptm_AL       0.054830
1                 iptm_L       0.039174
2         query_avg_RMSD       0.033496
3     chain_pair_iptm_AH       0.021611
4         model_avg_RMSD       0.015794
5  chain_pair_pae_min_AH       0.015113
6        avg_model_plddt       0.013372
7     interface_plddt_AH       0.010269
8      scaled_model_RMSD       0.008695
9                 iptm_A       0.008650
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lgbm/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: lgbm ---
Global SHAP Analysis Duration: 2.55 seconds
Result Aggregation & Global SHAP Duration: 2.64 seconds
Average time per outer fold: 2855.64 seconds
--- Nested CV completed for: LightGBM (lgbm) ---
Total execution time for model 'lgbm': 14280.89 seconds

--- Running Nested CV for Regression: XGBoost (xgb) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.6463476238100518, 'gamma': 0.43155171293779676, 'learning_rate': 0.1346596253655116, 'max_depth': 4, 'n_estimators': 132, 'reg_alpha': 0.06355835028602363, 'reg_lambda': 0.6219646434313244, 'subsample': 0.7300733288106989}
Best Inner CV Score (neg_mean_squared_error): -0.0173
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/best_params.json
Hyperparameter Tuning Duration: 284.37 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5439, RMSE=0.2146, MAE=0.1315
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.06 seconds
Calculating and saving SHAP values...
Calculating SHAP values for XGBoost using SHAP Explainer...
SHAP calculation took 0.10 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 1.28 seconds
-- Outer Fold 1 finished. Duration: 286.71 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.8012545034320351, 'gamma': 0.42824492059416114, 'learning_rate': 0.141738726323789, 'max_depth': 6, 'n_estimators': 115, 'reg_alpha': 0.07056874740042984, 'reg_lambda': 1.2848385564126312, 'subsample': 0.6106045242166487}
Best Inner CV Score (neg_mean_squared_error): -0.0259
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/best_params.json
Hyperparameter Tuning Duration: 369.12 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7925, RMSE=0.1554, MAE=0.1038
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.95 seconds
Calculating and saving SHAP values...
Calculating SHAP values for XGBoost using SHAP Explainer...
SHAP calculation took 0.02 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 1.48 seconds
-- Outer Fold 2 finished. Duration: 371.56 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.7620808347125668, 'gamma': 0.2857365126025053, 'learning_rate': 0.15819477218213368, 'max_depth': 7, 'n_estimators': 994, 'reg_alpha': 0.6492103021160636, 'reg_lambda': 1.4920897585308466, 'subsample': 0.8333475060388639}
Best Inner CV Score (neg_mean_squared_error): -0.0232
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/best_params.json
Hyperparameter Tuning Duration: 348.34 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5980, RMSE=0.1611, MAE=0.1007
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.99 seconds
Calculating and saving SHAP values...
Calculating SHAP values for XGBoost using SHAP Explainer...
SHAP calculation took 0.11 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 1.48 seconds
-- Outer Fold 3 finished. Duration: 350.85 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.9213923721539394, 'gamma': 0.14101728628565324, 'learning_rate': 0.045487908755944564, 'max_depth': 3, 'n_estimators': 291, 'reg_alpha': 0.5759245752580846, 'reg_lambda': 1.4632955105992804, 'subsample': 0.6510758917689862}
Best Inner CV Score (neg_mean_squared_error): -0.0254
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/best_params.json
Hyperparameter Tuning Duration: 324.10 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.2160, RMSE=0.2139, MAE=0.1181
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.51 seconds
Calculating and saving SHAP values...
Calculating SHAP values for XGBoost using SHAP Explainer...
SHAP calculation took 0.04 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 1.85 seconds
-- Outer Fold 4 finished. Duration: 327.52 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'colsample_bytree': 0.8012545034320351, 'gamma': 0.42824492059416114, 'learning_rate': 0.141738726323789, 'max_depth': 6, 'n_estimators': 115, 'reg_alpha': 0.07056874740042984, 'reg_lambda': 1.2848385564126312, 'subsample': 0.6106045242166487}
Best Inner CV Score (neg_mean_squared_error): -0.0291
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/best_params.json
Hyperparameter Tuning Duration: 297.64 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7697, RMSE=0.1572, MAE=0.0995
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.92 seconds
Calculating and saving SHAP values...
Calculating SHAP values for XGBoost using SHAP Explainer...
SHAP calculation took 0.04 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 1.58 seconds
-- Outer Fold 5 finished. Duration: 300.19 seconds --

--- Aggregating results for: XGBoost (xgb) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": 0.5840296020350754,
    "r2_std": 0.20743253055990626,
    "mse_mean": 0.033320767730620225,
    "mse_std": 0.01029073921848207,
    "rmse_mean": 0.18042924825201512,
    "rmse_std": 0.027677682450539937,
    "mae_mean": 0.11071894004180752,
    "mae_std": 0.012311804295410624,
    "best_inner_cv_score_mean": -0.02418015850714229,
    "best_inner_cv_score_std": 0.003919793299329452,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: xgb ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
                 feature  mean_abs_shap
0     chain_pair_iptm_AL       0.050255
1        avg_model_plddt       0.040824
2                 iptm_L       0.026393
3         query_avg_RMSD       0.020273
4  chain_pair_pae_min_AH       0.019563
5       interface_pae_AH       0.017910
6     interface_plddt_AH       0.017103
7         model_avg_RMSD       0.012274
8          chain_plddt_A       0.009091
9    avg_interface_plddt       0.008609
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/xgb/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: xgb ---
Global SHAP Analysis Duration: 2.60 seconds
Result Aggregation & Global SHAP Duration: 3.47 seconds
Average time per outer fold: 327.37 seconds
--- Nested CV completed for: XGBoost (xgb) ---
Total execution time for model 'xgb': 1640.30 seconds

--- Running Nested CV for Regression: Linear Regression (lr) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 2 candidates, totalling 6 fits
Best Params found: {'regressor__fit_intercept': True}
Best Inner CV Score (neg_mean_squared_error): -0.0300
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/best_params.json
Hyperparameter Tuning Duration: 0.27 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=-125084114.9488, RMSE=3553.4189, MAE=130.0109
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 2103.72 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Linear Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Linear Regression took 17.47 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 19.36 seconds
-- Outer Fold 1 finished. Duration: 2123.36 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 2 candidates, totalling 6 fits
Best Params found: {'regressor__fit_intercept': False}
Best Inner CV Score (neg_mean_squared_error): -90252505.6768
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/best_params.json
Hyperparameter Tuning Duration: 95.09 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.1511, RMSE=0.3143, MAE=0.2701
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.26 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Linear Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Linear Regression took 0.61 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 3.15 seconds
-- Outer Fold 2 finished. Duration: 99.51 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 2 candidates, totalling 6 fits
Best Params found: {'regressor__fit_intercept': False}
Best Inner CV Score (neg_mean_squared_error): -5759101.5239
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/best_params.json
Hyperparameter Tuning Duration: 1.05 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=-0.3188, RMSE=0.2918, MAE=0.2625
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.83 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Linear Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Linear Regression took 0.24 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 2.02 seconds
-- Outer Fold 3 finished. Duration: 3.90 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 2 candidates, totalling 6 fits
Best Params found: {'regressor__fit_intercept': True}
Best Inner CV Score (neg_mean_squared_error): -1326284.2578
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/best_params.json
Hyperparameter Tuning Duration: 1.56 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.0784, RMSE=0.2320, MAE=0.1676
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.73 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Linear Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Linear Regression took 0.37 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 1.55 seconds
-- Outer Fold 4 finished. Duration: 3.87 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 2 candidates, totalling 6 fits
Best Params found: {'regressor__fit_intercept': True}
Best Inner CV Score (neg_mean_squared_error): -95576.9941
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/best_params.json
Hyperparameter Tuning Duration: 3.38 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.1643, RMSE=0.2994, MAE=0.1770
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.83 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Linear Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Linear Regression took 0.29 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 1.60 seconds
-- Outer Fold 5 finished. Duration: 5.81 seconds --

--- Aggregating results for: Linear Regression (lr) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": -25016822.974763732,
    "r2_std": 50033645.987031594,
    "mse_mean": 2525357.2527078763,
    "mse_std": 5050714.341744911,
    "rmse_mean": 710.9112614345167,
    "rmse_std": 1421.2538235915006,
    "mae_mean": 26.177642529760572,
    "mae_std": 51.916635332168035,
    "best_inner_cv_score_mean": -19486693.696509745,
    "best_inner_cv_score_std": 35445152.10880584,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: lr ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
                 feature  mean_abs_shap
0             mpdockq_AH      26.668431
1      chain_pair_pae_AL       0.484210
2      chain_pair_pae_AH       0.481197
3     chain_pair_iptm_AL       0.199470
4     chain_pair_iptm_AH       0.194081
5       interface_pae_AH       0.138465
6                pdockq2       0.118596
7             pdockq2_AH       0.107849
8  chain_pair_pae_min_AH       0.106581
9                 iptm_H       0.089155
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lr/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: lr ---
Global SHAP Analysis Duration: 2.48 seconds
Result Aggregation & Global SHAP Duration: 2.64 seconds
Average time per outer fold: 447.29 seconds
--- Nested CV completed for: Linear Regression (lr) ---
Total execution time for model 'lr': 2239.11 seconds

--- Running Nested CV for Regression: Ridge Regression (ridge) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 83.4298801304735}
Best Inner CV Score (neg_mean_squared_error): -0.0235
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/best_params.json
Hyperparameter Tuning Duration: 1.05 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=-167125.9284, RMSE=129.8879, MAE=4.8882
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 78.48 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Ridge Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Ridge Regression took 0.27 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 1.62 seconds
-- Outer Fold 1 finished. Duration: 81.15 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 83.4298801304735}
Best Inner CV Score (neg_mean_squared_error): -65161652.7463
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/best_params.json
Hyperparameter Tuning Duration: 0.62 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7973, RMSE=0.1536, MAE=0.1108
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.90 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Ridge Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Ridge Regression took 0.26 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 1.78 seconds
-- Outer Fold 2 finished. Duration: 3.31 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 7.812113973534931}
Best Inner CV Score (neg_mean_squared_error): -686.9763
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/best_params.json
Hyperparameter Tuning Duration: 0.52 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.6648, RMSE=0.1471, MAE=0.1077
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.03 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Ridge Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Ridge Regression took 0.22 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 1.74 seconds
-- Outer Fold 3 finished. Duration: 3.31 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.35849855803404745}
Best Inner CV Score (neg_mean_squared_error): -1301145.1051
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/best_params.json
Hyperparameter Tuning Duration: 0.59 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.0788, RMSE=0.2319, MAE=0.1676
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.26 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Ridge Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Ridge Regression took 0.25 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 1.62 seconds
-- Outer Fold 4 finished. Duration: 3.47 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.00010792764548678457}
Best Inner CV Score (neg_mean_squared_error): -95603.5933
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/best_params.json
Hyperparameter Tuning Duration: 0.54 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.1643, RMSE=0.2994, MAE=0.1770
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.92 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Ridge Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Ridge Regression took 0.25 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 2.57 seconds
-- Outer Fold 5 finished. Duration: 4.04 seconds --

--- Aggregating results for: Ridge Regression (ridge) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": -33424.84462516602,
    "r2_std": 66850.54189398122,
    "mse_mean": 3374.2086718895453,
    "mse_std": 6748.323029217107,
    "rmse_mean": 26.14396004297303,
    "rmse_std": 51.87197726288227,
    "mae_mean": 1.0902734841194124,
    "mae_std": 1.8991973818361565,
    "best_inner_cv_score_mean": -13311817.688913448,
    "best_inner_cv_score_std": 25929599.521857444,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: ridge ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
                 feature  mean_abs_shap
0             mpdockq_AH       0.975435
1      chain_pair_pae_AL       0.202288
2      chain_pair_pae_AH       0.177416
3     chain_pair_iptm_AL       0.085220
4  chain_pair_pae_min_AH       0.073222
5     chain_pair_iptm_AH       0.064588
6       interface_pae_AH       0.059103
7      scaled_model_RMSD       0.057345
8             pdockq2_AH       0.053425
9                pdockq2       0.053257
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/ridge/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: ridge ---
Global SHAP Analysis Duration: 2.39 seconds
Result Aggregation & Global SHAP Duration: 2.47 seconds
Average time per outer fold: 19.05 seconds
--- Nested CV completed for: Ridge Regression (ridge) ---
Total execution time for model 'ridge': 97.75 seconds

--- Running Nested CV for Regression: Lasso Regression (lasso) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.02381502906658356, 'regressor__max_iter': 1000}
Best Inner CV Score (neg_mean_squared_error): -0.0188
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/best_params.json
Hyperparameter Tuning Duration: 1.07 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7139, RMSE=0.1700, MAE=0.1125
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.88 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Lasso Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Lasso Regression took 0.23 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 1.73 seconds
-- Outer Fold 1 finished. Duration: 3.69 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.02381502906658356, 'regressor__max_iter': 1000}
Best Inner CV Score (neg_mean_squared_error): -0.0198
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/best_params.json
Hyperparameter Tuning Duration: 0.93 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7977, RMSE=0.1534, MAE=0.1083
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.81 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Lasso Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Lasso Regression took 0.33 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 1.74 seconds
-- Outer Fold 2 finished. Duration: 3.51 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.05414413211338523, 'regressor__max_iter': 2000}
Best Inner CV Score (neg_mean_squared_error): -0.0271
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/best_params.json
Hyperparameter Tuning Duration: 1.07 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.6644, RMSE=0.1472, MAE=0.1111
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.92 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Lasso Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Lasso Regression took 0.28 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 1.52 seconds
-- Outer Fold 3 finished. Duration: 3.55 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.03490225247838249, 'regressor__max_iter': 2000}
Best Inner CV Score (neg_mean_squared_error): -0.0219
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/best_params.json
Hyperparameter Tuning Duration: 1.14 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5616, RMSE=0.1600, MAE=0.1012
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.03 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Lasso Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Lasso Regression took 0.24 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 1.44 seconds
-- Outer Fold 4 finished. Duration: 3.63 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.03490225247838249, 'regressor__max_iter': 2000}
Best Inner CV Score (neg_mean_squared_error): -0.0277
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/best_params.json
Hyperparameter Tuning Duration: 0.90 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8113, RMSE=0.1423, MAE=0.1017
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.98 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Lasso Regression using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Lasso Regression took 0.28 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 8.82 seconds
-- Outer Fold 5 finished. Duration: 10.70 seconds --

--- Aggregating results for: Lasso Regression (lasso) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": 0.7097784007457364,
    "r2_std": 0.09173834589717558,
    "mse_mean": 0.023983164493615698,
    "mse_std": 0.003040094351535515,
    "rmse_mean": 0.15455914279625627,
    "rmse_std": 0.009728097023681728,
    "mae_mean": 0.1069383007689868,
    "mae_std": 0.004699368115185095,
    "best_inner_cv_score_mean": -0.023066743370292818,
    "best_inner_cv_score_std": 0.0036994479092144327,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: lasso ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
              feature  mean_abs_shap
0   scaled_query_RMSD       0.047838
1  chain_pair_iptm_AL       0.043531
2              iptm_L       0.028492
3  chain_pair_iptm_AH       0.020831
4     avg_model_plddt       0.018636
5             pdockq2       0.013318
6          pdockq2_AH       0.012386
7              iptm_A       0.011334
8   scaled_model_RMSD       0.009665
9             mpdockq       0.007657
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/lasso/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: lasso ---
Global SHAP Analysis Duration: 2.42 seconds
Result Aggregation & Global SHAP Duration: 2.47 seconds
Average time per outer fold: 5.02 seconds
--- Nested CV completed for: Lasso Regression (lasso) ---
Total execution time for model 'lasso': 27.56 seconds

--- Running Nested CV for Regression: Elastic Net (en) ---
Output directory: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en
Hyperparameter tuning scoring metric: neg_mean_squared_error
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 100 to 3496
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.09046673956058787, 'regressor__l1_ratio': 0.27472179299006416, 'regressor__max_iter': 5000}
Best Inner CV Score (neg_mean_squared_error): -0.0186
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/best_params.json
Hyperparameter Tuning Duration: 1.00 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.7202, RMSE=0.1681, MAE=0.1115
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.03 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Elastic Net using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Elastic Net took 0.28 seconds.
--- Saving SHAP results for Fold 1 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/shap_values_fold_1.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/X_explain_fold_1.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/shap_expected_value_fold_1.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/shap_summary_dot_fold_1.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_1/shap_summary_bar_fold_1.png
--- SHAP saving completed for Fold 1 ---
SHAP Calculation & Saving Duration: 1.59 seconds
-- Outer Fold 1 finished. Duration: 3.65 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.09046673956058787, 'regressor__l1_ratio': 0.27472179299006416, 'regressor__max_iter': 5000}
Best Inner CV Score (neg_mean_squared_error): -0.0200
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/best_params.json
Hyperparameter Tuning Duration: 1.01 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8021, RMSE=0.1517, MAE=0.1093
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 1.13 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Elastic Net using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Elastic Net took 0.26 seconds.
--- Saving SHAP results for Fold 2 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/shap_values_fold_2.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/X_explain_fold_2.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/shap_expected_value_fold_2.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/shap_summary_dot_fold_2.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_2/shap_summary_bar_fold_2.png
--- SHAP saving completed for Fold 2 ---
SHAP Calculation & Saving Duration: 1.55 seconds
-- Outer Fold 2 finished. Duration: 3.72 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3396
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.35753161317240767, 'regressor__l1_ratio': 0.11089082081183133, 'regressor__max_iter': 1000}
Best Inner CV Score (neg_mean_squared_error): -0.0240
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/best_params.json
Hyperparameter Tuning Duration: 0.98 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.6898, RMSE=0.1415, MAE=0.1072
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/predictions.csv (shape: (749, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.84 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Elastic Net using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2898, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Elastic Net took 0.24 seconds.
--- Saving SHAP results for Fold 3 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/shap_values_fold_3.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/X_explain_fold_3.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/shap_expected_value_fold_3.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/shap_summary_dot_fold_3.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_3/shap_summary_bar_fold_3.png
--- SHAP saving completed for Fold 3 ---
SHAP Calculation & Saving Duration: 1.81 seconds
-- Outer Fold 3 finished. Duration: 3.64 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 300 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.0401949321712464, 'regressor__l1_ratio': 0.9611720243493491, 'regressor__max_iter': 1000}
Best Inner CV Score (neg_mean_squared_error): -0.0221
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/best_params.json
Hyperparameter Tuning Duration: 1.02 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.5679, RMSE=0.1588, MAE=0.1012
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.79 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Elastic Net using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Elastic Net took 0.22 seconds.
--- Saving SHAP results for Fold 4 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/shap_values_fold_4.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/X_explain_fold_4.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/shap_expected_value_fold_4.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/shap_summary_dot_fold_4.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_4/shap_summary_bar_fold_4.png
--- SHAP saving completed for Fold 4 ---
SHAP Calculation & Saving Duration: 4.83 seconds
-- Outer Fold 4 finished. Duration: 6.68 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3446
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 100 candidates, totalling 300 fits
Best Params found: {'regressor__alpha': 0.16224010950061366, 'regressor__l1_ratio': 0.08413996499504883, 'regressor__max_iter': 2000}
Best Inner CV Score (neg_mean_squared_error): -0.0268
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/best_params.json
Hyperparameter Tuning Duration: 0.97 seconds
Predicting on outer test set...
Calculating performance metrics...
Calculated Metrics: R2=0.8009, RMSE=0.1461, MAE=0.0952
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/metrics.json
Predictions saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/predictions.csv (shape: (700, 2))
Generating diagnostic plots...
Diagnostic plots saved.
Prediction & Evaluation Duration: 0.81 seconds
Calculating and saving SHAP values...
Sampling 100 instances from X_train for SHAP background data.
Calculating SHAP values for Elastic Net using shap.Explainer (forcing LinearExplainer)...
Scaling X_explain data...
Scaling data for kmeans...
Running kmeans with k=50 on SCALED data of shape (2947, 63) for SHAP background.
Warning: shap.kmeans does not support 'random_state' in this version. Running without it.
Initializing shap.Explainer with regressor and scaled background kmeans centers...
Calculating SHAP values on scaled explanation data...
SHAP calculation for Elastic Net took 0.25 seconds.
--- Saving SHAP results for Fold 5 ---
SHAP values saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/shap_values_fold_5.npy
X_explain saved to (CSV): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/X_explain_fold_5.csv
SHAP expected value saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/shap_expected_value_fold_5.joblib
SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/shap_summary_dot_fold_5.png
SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/fold_5/shap_summary_bar_fold_5.png
--- SHAP saving completed for Fold 5 ---
SHAP Calculation & Saving Duration: 1.68 seconds
-- Outer Fold 5 finished. Duration: 3.47 seconds --

--- Aggregating results for: Elastic Net (en) ---
Warning: Could not compute mean/std for metric 'scoring_metric_used'. Values: ['neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error', 'neg_mean_squared_error']
Average Metrics across folds:
{
    "r2_mean": 0.7161675620307284,
    "r2_std": 0.08634237385514354,
    "mse_mean": 0.023575831372493868,
    "mse_std": 0.0029118389300140214,
    "rmse_mean": 0.15325643389354912,
    "rmse_std": 0.009396639970014746,
    "mae_mean": 0.10487936064541761,
    "mae_std": 0.005929352526850466,
    "best_inner_cv_score_mean": -0.02228222870797559,
    "best_inner_cv_score_std": 0.002915491161086077,
    "scoring_metric_used_mean": "N/A",
    "scoring_metric_used_std": "N/A"
}
Results saved to /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/metrics_summary.json
Combined predictions saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/all_folds_predictions.csv

Running global SHAP analysis...

--- Analyzing Global SHAP for Model: en ---
Loading data from fold_1...
Loading data from fold_2...
Loading data from fold_3...
Loading data from fold_4...
Loading data from fold_5...
Loaded SHAP data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined X_explain shape: (3647, 63)
Combined SHAP data saved to (CSV for X_explain): /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/combined_shap
Global SHAP feature importance saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/combined_shap/global_shap_feature_importance.csv

Top 10 Features by Global Mean Absolute SHAP:
              feature  mean_abs_shap
0   scaled_query_RMSD       0.037464
1  chain_pair_iptm_AH       0.030780
2   scaled_model_RMSD       0.019590
3  chain_pair_iptm_AL       0.018397
4     avg_model_plddt       0.018239
5              iptm_L       0.016681
6          pdockq2_AH       0.015944
7              iptm_A       0.015487
8              iptm_H       0.010072
9             pdockq2       0.009226
Combined SHAP dot plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/combined_shap/combined_shap_summary_dot.png
Combined SHAP bar plot saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/en/combined_shap/combined_shap_summary_bar.png
--- Global SHAP analysis completed for: en ---
Global SHAP Analysis Duration: 2.97 seconds
Result Aggregation & Global SHAP Duration: 3.13 seconds
Average time per outer fold: 4.23 seconds
--- Nested CV completed for: Elastic Net (en) ---
Total execution time for model 'en': 24.33 seconds

--- Overall Training Summary ---
Model comparison summary saved to: /home/cseomoon/appl/af_analysis-0.1.4/model/regression/results/rg_final_20250425_215156/model_comparison_summary.csv
Successful Model Summary:
  model_name       r2_mean  ...  scoring_metric_used_mean  scoring_metric_used_std
0         rf  6.674920e-01  ...                       N/A                      N/A
1       lgbm  5.933078e-01  ...                       N/A                      N/A
2        xgb  5.840296e-01  ...                       N/A                      N/A
3         lr -2.501682e+07  ...                       N/A                      N/A
4      ridge -3.342484e+04  ...                       N/A                      N/A
5      lasso  7.097784e-01  ...                       N/A                      N/A
6         en  7.161676e-01  ...                       N/A                      N/A

[7 rows x 13 columns]
Final Summary Saving Duration: 0.06 seconds

--- Framework Execution Finished ---
Total script execution time: 19011.75 seconds
 
[INFO] Job completed at: Sat Apr 26 03:12:54 KST 2025
