=============================================
[INFO] Job Information
---------------------------------------------
[INFO] Job Name       : cls_framework
[INFO] Job ID         : 179777
[INFO] Submit Dir     : /home/cseomoon/appl/af_analysis-0.1.4/model/classification/scripts
[INFO] Partition      : g4090_short
[INFO] Node List      : gpu10
[INFO] Nodes          : 1
[INFO] CPUs per Task  : 32
[INFO] Memory (MB)    : 
[INFO] User           : cseomoon
[INFO] Work Dir       : /home/cseomoon/appl/af_analysis-0.1.4/model/classification/scripts
[INFO] Tasks per Node : 1
[INFO] Dependency     : 
[INFO] GPU(s)         : 
=============================================

[INFO] Job started at : Wed Apr 23 19:41:21 KST 2025
[INFO] Job allocated on node(s): gpu10
[INFO] Job running on: gpu10
Using 32 CPU cores.
Results will be saved to: ../results/cls_test_2
Results saved to ../results/cls_test_2/run_arguments.json

--- Loading Data ---
Original data shape: (3650, 81)
Class distribution before NaN drop (DockQ >= 0.23): 0 (Negative) = 2529, 1 (Positive) = 1121
Identified 63 potential feature columns.
Checking for NaN values in potential feature columns...
Dropped 3 rows containing NaN values in one or more feature columns.
Processed Features (X) shape after NaN drop: (3647, 63)
Processed Target (y) shape after NaN drop: (3647,)
Processed Query IDs shape after NaN drop: (3647,)
Class distribution after NaN drop (DockQ >= 0.23): 0 (Negative) = 2526, 1 (Positive) = 1121
Data Loading & Preprocessing Duration: 0.26 seconds

--- Starting Model Training ---

--- Running Nested CV for: Random Forest (rf) ---
Output directory: ../results/cls_test_2/rf
Using GroupKFold for outer CV with 2 folds based on query IDs.

-- Processing Outer Fold 1/2 --
Train set size: (1799, 63), Test set size: (1848, 63)
Test set indices range from 0 to 3646
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'n_estimators': 700, 'min_samples_split': 2, 'min_samples_leaf': 4, 'max_features': 'log2', 'max_depth': 30, 'class_weight': 'balanced_subsample'}
Best Inner CV ROC AUC score: 0.9385
Results saved to ../results/cls_test_2/rf/fold_1/best_params.json
Hyperparameter Tuning Duration: 8.75 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/rf/fold_1/metrics.json
Predictions saved to ../results/cls_test_2/rf/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.36 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_test_2/rf/fold_1/shap_values_fold_1.csv (shape: (1848, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/rf/fold_1/test_data_fold_1.csv (shape: (1848, 63))
SHAP Calculation & Saving Duration: 9.59 seconds
-- Outer Fold 1 finished. Duration: 18.71 seconds --

-- Processing Outer Fold 2/2 --
Train set size: (1848, 63), Test set size: (1799, 63)
Test set indices range from 150 to 3496
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'n_estimators': 500, 'min_samples_split': 5, 'min_samples_leaf': 2, 'max_features': 'sqrt', 'max_depth': 30, 'class_weight': 'balanced_subsample'}
Best Inner CV ROC AUC score: 0.9519
Results saved to ../results/cls_test_2/rf/fold_2/best_params.json
Hyperparameter Tuning Duration: 6.96 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/rf/fold_2/metrics.json
Predictions saved to ../results/cls_test_2/rf/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.83 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_test_2/rf/fold_2/shap_values_fold_2.csv (shape: (1799, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/rf/fold_2/test_data_fold_2.csv (shape: (1799, 63))
SHAP Calculation & Saving Duration: 8.40 seconds
-- Outer Fold 2 finished. Duration: 16.21 seconds --

--- Aggregating results for: Random Forest (rf) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.892167576262907,
    "accuracy_std": 0.015003074098404845,
    "precision_mean": 0.8389379147413404,
    "precision_std": 0.06012750581940729,
    "recall_mean": 0.8163451401030719,
    "recall_std": 0.08087113398686391,
    "f1_mean": 0.8214570545087849,
    "f1_std": 0.01237379126235938,
    "roc_auc_mean": 0.9410410208499603,
    "roc_auc_std": 0.002935611028170415,
    "pr_auc_mean": 0.9062020852436223,
    "pr_auc_std": 0.00860697195366461,
    "balanced_accuracy_mean": 0.8745312025533845,
    "balanced_accuracy_std": 0.029407264821913692,
    "mcc_mean": 0.7506705397949676,
    "mcc_std": 0.02291275110989588,
    "best_inner_cv_roc_auc_mean": 0.9452325345358301,
    "best_inner_cv_roc_auc_std": 0.0066870853924950735
}
Results saved to ../results/cls_test_2/rf/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_test_2/rf ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_test_2/rf...
Found 2 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_test_2/rf...
Found 2 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv']
Found matching SHAP and test data for folds: [1, 2]

Loading Fold 1:
  SHAP file: ../results/cls_test_2/rf/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_test_2/rf/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (1848, 63)
  Loaded Test Data shape: (1848, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_test_2/rf/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_test_2/rf/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (1799, 63)
  Loaded Test Data shape: (1799, 63)

Combining data from 2 folds...
Successfully combined data from 2 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_test_2/rf/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_test_2/rf/global_shap_analysis/rf_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_test_2/rf/global_shap_analysis/rf_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: rf ---
Global SHAP Analysis Duration: 2.73 seconds
Result Aggregation & Global SHAP Duration: 2.90 seconds
Average time per outer fold: 17.46 seconds
--- Nested CV completed for: Random Forest (rf) ---
Total execution time for model 'rf': 37.82 seconds

--- Running Nested CV for: XGBoost (xgb) ---
Output directory: ../results/cls_test_2/xgb
Using GroupKFold for outer CV with 2 folds based on query IDs.

-- Processing Outer Fold 1/2 --
Train set size: (1799, 63), Test set size: (1848, 63)
Test set indices range from 0 to 3646
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'subsample': 0.8, 'scale_pos_weight': 1, 'n_estimators': 500, 'max_depth': 3, 'learning_rate': 0.01, 'gamma': 0.1, 'colsample_bytree': 1.0}
Best Inner CV ROC AUC score: 0.9375
Results saved to ../results/cls_test_2/xgb/fold_1/best_params.json
Hyperparameter Tuning Duration: 4.74 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/xgb/fold_1/metrics.json
Predictions saved to ../results/cls_test_2/xgb/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.32 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_test_2/xgb/fold_1/shap_values_fold_1.csv (shape: (1848, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/xgb/fold_1/test_data_fold_1.csv (shape: (1848, 63))
SHAP Calculation & Saving Duration: 0.82 seconds
-- Outer Fold 1 finished. Duration: 5.88 seconds --

-- Processing Outer Fold 2/2 --
Train set size: (1848, 63), Test set size: (1799, 63)
Test set indices range from 150 to 3496
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'subsample': 0.8, 'scale_pos_weight': 7, 'n_estimators': 200, 'max_depth': 10, 'learning_rate': 0.05, 'gamma': 1, 'colsample_bytree': 0.8}
Best Inner CV ROC AUC score: 0.9461
Results saved to ../results/cls_test_2/xgb/fold_2/best_params.json
Hyperparameter Tuning Duration: 1.18 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/xgb/fold_2/metrics.json
Predictions saved to ../results/cls_test_2/xgb/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.20 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_test_2/xgb/fold_2/shap_values_fold_2.csv (shape: (1799, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/xgb/fold_2/test_data_fold_2.csv (shape: (1799, 63))
SHAP Calculation & Saving Duration: 0.57 seconds
-- Outer Fold 2 finished. Duration: 1.98 seconds --

--- Aggregating results for: XGBoost (xgb) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.8592652483703067,
    "accuracy_std": 0.015109404214462607,
    "precision_mean": 0.821191541904615,
    "precision_std": 0.11660750115758606,
    "recall_mean": 0.7440196714011618,
    "recall_std": 0.14463129219626875,
    "f1_mean": 0.758664066033469,
    "f1_std": 0.027320782451379477,
    "roc_auc_mean": 0.9401214438096217,
    "roc_auc_std": 0.0019276716870311739,
    "pr_auc_mean": 0.8974846596947763,
    "pr_auc_std": 0.010402930308759883,
    "balanced_accuracy_mean": 0.8339082919457708,
    "balanced_accuracy_std": 0.04510187453762915,
    "mcc_mean": 0.6841850009659568,
    "mcc_std": 0.02399078847133862,
    "best_inner_cv_roc_auc_mean": 0.9417815250034285,
    "best_inner_cv_roc_auc_std": 0.004301748939949723
}
Results saved to ../results/cls_test_2/xgb/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_test_2/xgb ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_test_2/xgb...
Found 2 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_test_2/xgb...
Found 2 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv']
Found matching SHAP and test data for folds: [1, 2]

Loading Fold 1:
  SHAP file: ../results/cls_test_2/xgb/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_test_2/xgb/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (1848, 63)
  Loaded Test Data shape: (1848, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_test_2/xgb/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_test_2/xgb/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (1799, 63)
  Loaded Test Data shape: (1799, 63)

Combining data from 2 folds...
Successfully combined data from 2 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_test_2/xgb/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_test_2/xgb/global_shap_analysis/xgb_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_test_2/xgb/global_shap_analysis/xgb_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: xgb ---
Global SHAP Analysis Duration: 1.14 seconds
Result Aggregation & Global SHAP Duration: 1.18 seconds
Average time per outer fold: 3.93 seconds
--- Nested CV completed for: XGBoost (xgb) ---
Total execution time for model 'xgb': 9.04 seconds

--- Running Nested CV for: LightGBM (lgb) ---
Output directory: ../results/cls_test_2/lgb
Using GroupKFold for outer CV with 2 folds based on query IDs.

-- Processing Outer Fold 1/2 --
Train set size: (1799, 63), Test set size: (1848, 63)
Test set indices range from 0 to 3646
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'subsample': 1.0, 'reg_lambda': 5, 'reg_alpha': 0.01, 'num_leaves': 60, 'n_estimators': 100, 'max_depth': 20, 'learning_rate': 0.2, 'colsample_bytree': 0.6, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9437
Results saved to ../results/cls_test_2/lgb/fold_1/best_params.json
Hyperparameter Tuning Duration: 38.19 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/lgb/fold_1/metrics.json
Predictions saved to ../results/cls_test_2/lgb/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.10 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_test_2/lgb/fold_1/shap_values_fold_1.csv (shape: (1848, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/lgb/fold_1/test_data_fold_1.csv (shape: (1848, 63))
SHAP Calculation & Saving Duration: 0.66 seconds
-- Outer Fold 1 finished. Duration: 38.95 seconds --

-- Processing Outer Fold 2/2 --
Train set size: (1848, 63), Test set size: (1799, 63)
Test set indices range from 150 to 3496
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'subsample': 0.8, 'reg_lambda': 0, 'reg_alpha': 0, 'num_leaves': 31, 'n_estimators': 500, 'max_depth': 20, 'learning_rate': 0.05, 'colsample_bytree': 0.8, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9465
Results saved to ../results/cls_test_2/lgb/fold_2/best_params.json
Hyperparameter Tuning Duration: 55.68 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/lgb/fold_2/metrics.json
Predictions saved to ../results/cls_test_2/lgb/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.21 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_test_2/lgb/fold_2/shap_values_fold_2.csv (shape: (1799, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/lgb/fold_2/test_data_fold_2.csv (shape: (1799, 63))
SHAP Calculation & Saving Duration: 1.09 seconds
-- Outer Fold 2 finished. Duration: 56.99 seconds --

--- Aggregating results for: LightGBM (lgb) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.8777593191503696,
    "accuracy_std": 0.003841570232620828,
    "precision_mean": 0.8459589407306065,
    "precision_std": 0.12078163576606754,
    "recall_mean": 0.7712348322626694,
    "recall_std": 0.10456816559600285,
    "f1_mean": 0.7912723665904473,
    "f1_std": 0.0021320950972346098,
    "roc_auc_mean": 0.9295707100501508,
    "roc_auc_std": 0.013192181320877516,
    "pr_auc_mean": 0.9000291906554978,
    "pr_auc_std": 0.002022055220978536,
    "balanced_accuracy_mean": 0.8533851210221552,
    "balanced_accuracy_std": 0.026333194723997755,
    "mcc_mean": 0.7229390287931617,
    "mcc_std": 0.0052619706277954315,
    "best_inner_cv_roc_auc_mean": 0.9451093532800161,
    "best_inner_cv_roc_auc_std": 0.0013916587488993493
}
Results saved to ../results/cls_test_2/lgb/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_test_2/lgb ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_test_2/lgb...
Found 2 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_test_2/lgb...
Found 2 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv']
Found matching SHAP and test data for folds: [1, 2]

Loading Fold 1:
  SHAP file: ../results/cls_test_2/lgb/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_test_2/lgb/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (1848, 63)
  Loaded Test Data shape: (1848, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_test_2/lgb/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_test_2/lgb/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (1799, 63)
  Loaded Test Data shape: (1799, 63)

Combining data from 2 folds...
Successfully combined data from 2 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_test_2/lgb/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_test_2/lgb/global_shap_analysis/lgb_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_test_2/lgb/global_shap_analysis/lgb_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: lgb ---
Global SHAP Analysis Duration: 1.46 seconds
Result Aggregation & Global SHAP Duration: 1.52 seconds
Average time per outer fold: 47.97 seconds
--- Nested CV completed for: LightGBM (lgb) ---
Total execution time for model 'lgb': 97.46 seconds

--- Running Nested CV for: Logistic Regression (logistic) ---
Output directory: ../results/cls_test_2/logistic
Using GroupKFold for outer CV with 2 folds based on query IDs.

-- Processing Outer Fold 1/2 --
Train set size: (1799, 63), Test set size: (1848, 63)
Test set indices range from 0 to 3646
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'model__solver': 'liblinear', 'model__penalty': 'l2', 'model__class_weight': None, 'model__C': 0.005994842503189409}
Best Inner CV ROC AUC score: 0.9485
Results saved to ../results/cls_test_2/logistic/fold_1/best_params.json
Hyperparameter Tuning Duration: 1.42 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/logistic/fold_1/metrics.json
Predictions saved to ../results/cls_test_2/logistic/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.06 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_test_2/logistic/fold_1/shap_values_fold_1.csv (shape: (1848, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/logistic/fold_1/test_data_fold_1.csv (shape: (1848, 63))
SHAP Calculation & Saving Duration: 9.86 seconds
-- Outer Fold 1 finished. Duration: 11.35 seconds --

-- Processing Outer Fold 2/2 --
Train set size: (1848, 63), Test set size: (1799, 63)
Test set indices range from 150 to 3496
Using GroupKFold for inner CV with 2 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 2 folds for each of 20 candidates, totalling 40 fits
Best Params found: {'model__solver': 'saga', 'model__penalty': 'elasticnet', 'model__max_iter': 2000, 'model__l1_ratio': 0.1, 'model__class_weight': None, 'model__C': 0.005994842503189409}
Best Inner CV ROC AUC score: 0.9627
Results saved to ../results/cls_test_2/logistic/fold_2/best_params.json
Hyperparameter Tuning Duration: 1.58 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_test_2/logistic/fold_2/metrics.json
Predictions saved to ../results/cls_test_2/logistic/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.09 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_test_2/logistic/fold_2/shap_values_fold_2.csv (shape: (1799, 63))
Test data corresponding to SHAP values saved to ../results/cls_test_2/logistic/fold_2/test_data_fold_2.csv (shape: (1799, 63))
SHAP Calculation & Saving Duration: 6.43 seconds
-- Outer Fold 2 finished. Duration: 8.10 seconds --

--- Aggregating results for: Logistic Regression (logistic) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.9026110886519447,
    "accuracy_std": 0.016788577829433826,
    "precision_mean": 0.862505015136594,
    "precision_std": 0.03659408396250502,
    "recall_mean": 0.8183293060657852,
    "recall_std": 0.055332364169760784,
    "f1_mean": 0.8372955521758851,
    "f1_std": 0.01181995250673712,
    "roc_auc_mean": 0.9242838074807951,
    "roc_auc_std": 0.007991079826212166,
    "pr_auc_mean": 0.9025210483758774,
    "pr_auc_std": 0.012266442258500543,
    "balanced_accuracy_mean": 0.8812982187594232,
    "balanced_accuracy_std": 0.023250334076067525,
    "mcc_mean": 0.7708822981991927,
    "mcc_std": 0.023889540009549293,
    "best_inner_cv_roc_auc_mean": 0.9555807280686304,
    "best_inner_cv_roc_auc_std": 0.007101355436228474
}
Results saved to ../results/cls_test_2/logistic/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_test_2/logistic ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_test_2/logistic...
Found 2 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_test_2/logistic...
Found 2 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv']
Found matching SHAP and test data for folds: [1, 2]

Loading Fold 1:
  SHAP file: ../results/cls_test_2/logistic/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_test_2/logistic/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (1848, 63)
  Loaded Test Data shape: (1848, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_test_2/logistic/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_test_2/logistic/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (1799, 63)
  Loaded Test Data shape: (1799, 63)

Combining data from 2 folds...
Successfully combined data from 2 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_test_2/logistic/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_test_2/logistic/global_shap_analysis/logistic_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_test_2/logistic/global_shap_analysis/logistic_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: logistic ---
Global SHAP Analysis Duration: 1.28 seconds
Result Aggregation & Global SHAP Duration: 1.34 seconds
Average time per outer fold: 9.73 seconds
--- Nested CV completed for: Logistic Regression (logistic) ---
Total execution time for model 'logistic': 20.80 seconds

--- Overall Training Summary ---
Model comparison summary saved to: ../results/cls_test_2/model_comparison_summary.csv
  model_name  ...  best_inner_cv_roc_auc_std
0         rf  ...                   0.006687
1        xgb  ...                   0.004302
2        lgb  ...                   0.001392
3   logistic  ...                   0.007101

[4 rows x 19 columns]
Final Summary Saving Duration: 0.06 seconds

--- Framework Execution Finished ---
Total script execution time: 165.46 seconds
작업 완료
[INFO] Job completed at: Wed Apr 23 19:44:27 KST 2025
