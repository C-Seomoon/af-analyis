=============================================
[INFO] Job Information
---------------------------------------------
[INFO] Job Name       : cls_framework
[INFO] Job ID         : 179778
[INFO] Submit Dir     : /home/cseomoon/appl/af_analysis-0.1.4/model/classification/scripts
[INFO] Partition      : g4090_short
[INFO] Node List      : gpu10
[INFO] Nodes          : 1
[INFO] CPUs per Task  : 32
[INFO] Memory (MB)    : 
[INFO] User           : cseomoon
[INFO] Work Dir       : /home/cseomoon/appl/af_analysis-0.1.4/model/classification/scripts
[INFO] Tasks per Node : 1
[INFO] Dependency     : 
[INFO] GPU(s)         : 
=============================================

[INFO] Job started at : Wed Apr 23 19:48:47 KST 2025
[INFO] Job allocated on node(s): gpu10
[INFO] Job running on: gpu10
Using 32 CPU cores.
Results will be saved to: ../results/cls_250423
Results saved to ../results/cls_250423/run_arguments.json

--- Loading Data ---
Original data shape: (3650, 81)
Class distribution before NaN drop (DockQ >= 0.23): 0 (Negative) = 2529, 1 (Positive) = 1121
Identified 63 potential feature columns.
Checking for NaN values in potential feature columns...
Dropped 3 rows containing NaN values in one or more feature columns.
Processed Features (X) shape after NaN drop: (3647, 63)
Processed Target (y) shape after NaN drop: (3647,)
Processed Query IDs shape after NaN drop: (3647,)
Class distribution after NaN drop (DockQ >= 0.23): 0 (Negative) = 2526, 1 (Positive) = 1121
Data Loading & Preprocessing Duration: 0.05 seconds

--- Starting Model Training ---

--- Running Nested CV for: Random Forest (rf) ---
Output directory: ../results/cls_250423/rf
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 650 to 3546
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'n_estimators': 700, 'min_samples_split': 5, 'min_samples_leaf': 4, 'max_features': 'log2', 'max_depth': 30, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9181
Results saved to ../results/cls_250423/rf/fold_1/best_params.json
Hyperparameter Tuning Duration: 104.22 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/rf/fold_1/metrics.json
Predictions saved to ../results/cls_250423/rf/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.35 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_250423/rf/fold_1/shap_values_fold_1.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/rf/fold_1/test_data_fold_1.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 8.98 seconds
-- Outer Fold 1 finished. Duration: 113.55 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3097
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'n_estimators': 500, 'min_samples_split': 5, 'min_samples_leaf': 4, 'max_features': 'log2', 'max_depth': 40, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9606
Results saved to ../results/cls_250423/rf/fold_2/best_params.json
Hyperparameter Tuning Duration: 91.11 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/rf/fold_2/metrics.json
Predictions saved to ../results/cls_250423/rf/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.27 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_250423/rf/fold_2/shap_values_fold_2.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/rf/fold_2/test_data_fold_2.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 4.31 seconds
-- Outer Fold 2 finished. Duration: 95.69 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3147
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'n_estimators': 700, 'min_samples_split': 10, 'min_samples_leaf': 4, 'max_features': 'log2', 'max_depth': 10, 'class_weight': 'balanced_subsample'}
Best Inner CV ROC AUC score: 0.9326
Results saved to ../results/cls_250423/rf/fold_3/best_params.json
Hyperparameter Tuning Duration: 105.66 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/rf/fold_3/metrics.json
Predictions saved to ../results/cls_250423/rf/fold_3/predictions.csv
Prediction & Evaluation Duration: 0.26 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_250423/rf/fold_3/shap_values_fold_3.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/rf/fold_3/test_data_fold_3.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 6.16 seconds
-- Outer Fold 3 finished. Duration: 112.09 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 250 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'n_estimators': 200, 'min_samples_split': 10, 'min_samples_leaf': 1, 'max_features': 'log2', 'max_depth': None, 'class_weight': 'balanced'}
Best Inner CV ROC AUC score: 0.9569
Results saved to ../results/cls_250423/rf/fold_4/best_params.json
Hyperparameter Tuning Duration: 110.35 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/rf/fold_4/metrics.json
Predictions saved to ../results/cls_250423/rf/fold_4/predictions.csv
Prediction & Evaluation Duration: 0.14 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_250423/rf/fold_4/shap_values_fold_4.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/rf/fold_4/test_data_fold_4.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 2.22 seconds
-- Outer Fold 4 finished. Duration: 112.72 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'n_estimators': 100, 'min_samples_split': 10, 'min_samples_leaf': 2, 'max_features': 'log2', 'max_depth': 30, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9165
Results saved to ../results/cls_250423/rf/fold_5/best_params.json
Hyperparameter Tuning Duration: 110.01 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/rf/fold_5/metrics.json
Predictions saved to ../results/cls_250423/rf/fold_5/predictions.csv
Prediction & Evaluation Duration: 0.08 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for RandomForest...
SHAP explainer returned a 3D ndarray. Returning values for the positive class (index 1).
SHAP values saved to ../results/cls_250423/rf/fold_5/shap_values_fold_5.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/rf/fold_5/test_data_fold_5.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 1.52 seconds
-- Outer Fold 5 finished. Duration: 111.63 seconds --

--- Aggregating results for: Random Forest (rf) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.892777036048064,
    "accuracy_std": 0.046607950093746395,
    "precision_mean": 0.8776777309126474,
    "precision_std": 0.12362342675343863,
    "recall_mean": 0.757845422433225,
    "recall_std": 0.14266953158087134,
    "f1_mean": 0.7993038519848941,
    "f1_std": 0.1043169574713445,
    "roc_auc_mean": 0.9344878088778474,
    "roc_auc_std": 0.05295477355769503,
    "pr_auc_mean": 0.9018612839191544,
    "pr_auc_std": 0.06231418359047925,
    "balanced_accuracy_mean": 0.8504267051870469,
    "balanced_accuracy_std": 0.06756922389202238,
    "mcc_mean": 0.7378461243042079,
    "mcc_std": 0.11483054260696571,
    "best_inner_cv_roc_auc_mean": 0.936934458585462,
    "best_inner_cv_roc_auc_std": 0.01870606892938605
}
Results saved to ../results/cls_250423/rf/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_250423/rf ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_250423/rf...
Found 5 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv', 'shap_values_fold_3.csv', 'shap_values_fold_4.csv', 'shap_values_fold_5.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_250423/rf...
Found 5 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv', 'test_data_fold_3.csv', 'test_data_fold_4.csv', 'test_data_fold_5.csv']
Found matching SHAP and test data for folds: [1, 2, 3, 4, 5]

Loading Fold 1:
  SHAP file: ../results/cls_250423/rf/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_250423/rf/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_250423/rf/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_250423/rf/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 3:
  SHAP file: ../results/cls_250423/rf/fold_3/shap_values_fold_3.csv
  Test data file: ../results/cls_250423/rf/fold_3/test_data_fold_3.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 4:
  SHAP file: ../results/cls_250423/rf/fold_4/shap_values_fold_4.csv
  Test data file: ../results/cls_250423/rf/fold_4/test_data_fold_4.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Loading Fold 5:
  SHAP file: ../results/cls_250423/rf/fold_5/shap_values_fold_5.csv
  Test data file: ../results/cls_250423/rf/fold_5/test_data_fold_5.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Combining data from 5 folds...
Successfully combined data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_250423/rf/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_250423/rf/global_shap_analysis/rf_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_250423/rf/global_shap_analysis/rf_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: rf ---
Global SHAP Analysis Duration: 2.90 seconds
Result Aggregation & Global SHAP Duration: 2.97 seconds
Average time per outer fold: 109.14 seconds
--- Nested CV completed for: Random Forest (rf) ---
Total execution time for model 'rf': 548.66 seconds

--- Running Nested CV for: XGBoost (xgb) ---
Output directory: ../results/cls_250423/xgb
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 650 to 3546
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.8, 'scale_pos_weight': 3, 'n_estimators': 500, 'max_depth': 10, 'learning_rate': 0.05, 'gamma': 0.1, 'colsample_bytree': 0.6}
Best Inner CV ROC AUC score: 0.9094
Results saved to ../results/cls_250423/xgb/fold_1/best_params.json
Hyperparameter Tuning Duration: 15.50 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/xgb/fold_1/metrics.json
Predictions saved to ../results/cls_250423/xgb/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.07 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_250423/xgb/fold_1/shap_values_fold_1.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/xgb/fold_1/test_data_fold_1.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 0.38 seconds
-- Outer Fold 1 finished. Duration: 15.95 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3097
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.8, 'scale_pos_weight': 1, 'n_estimators': 300, 'max_depth': 3, 'learning_rate': 0.05, 'gamma': 1, 'colsample_bytree': 0.6}
Best Inner CV ROC AUC score: 0.9460
Results saved to ../results/cls_250423/xgb/fold_2/best_params.json
Hyperparameter Tuning Duration: 9.72 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/xgb/fold_2/metrics.json
Predictions saved to ../results/cls_250423/xgb/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.26 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_250423/xgb/fold_2/shap_values_fold_2.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/xgb/fold_2/test_data_fold_2.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 0.31 seconds
-- Outer Fold 2 finished. Duration: 10.30 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3147
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.6, 'scale_pos_weight': 7, 'n_estimators': 200, 'max_depth': 3, 'learning_rate': 0.01, 'gamma': 0.1, 'colsample_bytree': 0.6}
Best Inner CV ROC AUC score: 0.9210
Results saved to ../results/cls_250423/xgb/fold_3/best_params.json
Hyperparameter Tuning Duration: 9.80 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/xgb/fold_3/metrics.json
Predictions saved to ../results/cls_250423/xgb/fold_3/predictions.csv
Prediction & Evaluation Duration: 0.03 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_250423/xgb/fold_3/shap_values_fold_3.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/xgb/fold_3/test_data_fold_3.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 0.17 seconds
-- Outer Fold 3 finished. Duration: 10.02 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 250 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.6, 'scale_pos_weight': 5, 'n_estimators': 300, 'max_depth': 3, 'learning_rate': 0.05, 'gamma': 1, 'colsample_bytree': 0.6}
Best Inner CV ROC AUC score: 0.9461
Results saved to ../results/cls_250423/xgb/fold_4/best_params.json
Hyperparameter Tuning Duration: 10.07 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/xgb/fold_4/metrics.json
Predictions saved to ../results/cls_250423/xgb/fold_4/predictions.csv
Prediction & Evaluation Duration: 0.16 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_250423/xgb/fold_4/shap_values_fold_4.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/xgb/fold_4/test_data_fold_4.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 0.39 seconds
-- Outer Fold 4 finished. Duration: 10.62 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 1.0, 'scale_pos_weight': 1, 'n_estimators': 200, 'max_depth': 3, 'learning_rate': 0.01, 'gamma': 0.1, 'colsample_bytree': 0.6}
Best Inner CV ROC AUC score: 0.8957
Results saved to ../results/cls_250423/xgb/fold_5/best_params.json
Hyperparameter Tuning Duration: 10.60 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/xgb/fold_5/metrics.json
Predictions saved to ../results/cls_250423/xgb/fold_5/predictions.csv
Prediction & Evaluation Duration: 0.24 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for XGBoost...
Returning SHAP values (expected for positive class log-odds).
SHAP values saved to ../results/cls_250423/xgb/fold_5/shap_values_fold_5.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/xgb/fold_5/test_data_fold_5.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 1.00 seconds
-- Outer Fold 5 finished. Duration: 11.85 seconds --

--- Aggregating results for: XGBoost (xgb) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.8596929238985315,
    "accuracy_std": 0.06816285094715273,
    "precision_mean": 0.7952875879418896,
    "precision_std": 0.15572855336497313,
    "recall_mean": 0.767263334694739,
    "recall_std": 0.17084335190141034,
    "f1_mean": 0.7576138107494756,
    "f1_std": 0.12349739680682156,
    "roc_auc_mean": 0.9355326908476844,
    "roc_auc_std": 0.04831250831370361,
    "pr_auc_mean": 0.8956788530118439,
    "pr_auc_std": 0.06442198776968594,
    "balanced_accuracy_mean": 0.8271881898691655,
    "balanced_accuracy_std": 0.07460784893579438,
    "mcc_mean": 0.6771961803794526,
    "mcc_std": 0.14273245932178893,
    "best_inner_cv_roc_auc_mean": 0.9236327578138204,
    "best_inner_cv_roc_auc_std": 0.020010584026115608
}
Results saved to ../results/cls_250423/xgb/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_250423/xgb ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_250423/xgb...
Found 5 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv', 'shap_values_fold_3.csv', 'shap_values_fold_4.csv', 'shap_values_fold_5.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_250423/xgb...
Found 5 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv', 'test_data_fold_3.csv', 'test_data_fold_4.csv', 'test_data_fold_5.csv']
Found matching SHAP and test data for folds: [1, 2, 3, 4, 5]

Loading Fold 1:
  SHAP file: ../results/cls_250423/xgb/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_250423/xgb/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_250423/xgb/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_250423/xgb/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 3:
  SHAP file: ../results/cls_250423/xgb/fold_3/shap_values_fold_3.csv
  Test data file: ../results/cls_250423/xgb/fold_3/test_data_fold_3.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 4:
  SHAP file: ../results/cls_250423/xgb/fold_4/shap_values_fold_4.csv
  Test data file: ../results/cls_250423/xgb/fold_4/test_data_fold_4.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Loading Fold 5:
  SHAP file: ../results/cls_250423/xgb/fold_5/shap_values_fold_5.csv
  Test data file: ../results/cls_250423/xgb/fold_5/test_data_fold_5.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Combining data from 5 folds...
Successfully combined data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_250423/xgb/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_250423/xgb/global_shap_analysis/xgb_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_250423/xgb/global_shap_analysis/xgb_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: xgb ---
Global SHAP Analysis Duration: 1.67 seconds
Result Aggregation & Global SHAP Duration: 1.72 seconds
Average time per outer fold: 11.75 seconds
--- Nested CV completed for: XGBoost (xgb) ---
Total execution time for model 'xgb': 60.49 seconds

--- Running Nested CV for: LightGBM (lgb) ---
Output directory: ../results/cls_250423/lgb
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 650 to 3546
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.6, 'reg_lambda': 0, 'reg_alpha': 0, 'num_leaves': 50, 'n_estimators': 300, 'max_depth': -1, 'learning_rate': 0.1, 'colsample_bytree': 0.6, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9176
Results saved to ../results/cls_250423/lgb/fold_1/best_params.json
Hyperparameter Tuning Duration: 830.08 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/lgb/fold_1/metrics.json
Predictions saved to ../results/cls_250423/lgb/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.03 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_250423/lgb/fold_1/shap_values_fold_1.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/lgb/fold_1/test_data_fold_1.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 0.54 seconds
-- Outer Fold 1 finished. Duration: 830.65 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3097
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 1.0, 'reg_lambda': 1, 'reg_alpha': 0.5, 'num_leaves': 31, 'n_estimators': 100, 'max_depth': 20, 'learning_rate': 0.1, 'colsample_bytree': 0.6, 'class_weight': 'balanced'}
Best Inner CV ROC AUC score: 0.9522
Results saved to ../results/cls_250423/lgb/fold_2/best_params.json
Hyperparameter Tuning Duration: 668.99 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/lgb/fold_2/metrics.json
Predictions saved to ../results/cls_250423/lgb/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.15 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_250423/lgb/fold_2/shap_values_fold_2.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/lgb/fold_2/test_data_fold_2.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 1.99 seconds
-- Outer Fold 2 finished. Duration: 671.13 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3147
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 1.0, 'reg_lambda': 0.1, 'reg_alpha': 0.1, 'num_leaves': 31, 'n_estimators': 200, 'max_depth': -1, 'learning_rate': 0.2, 'colsample_bytree': 1.0, 'class_weight': 'balanced'}
Best Inner CV ROC AUC score: 0.9155
Results saved to ../results/cls_250423/lgb/fold_3/best_params.json
Hyperparameter Tuning Duration: 765.52 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/lgb/fold_3/metrics.json
Predictions saved to ../results/cls_250423/lgb/fold_3/predictions.csv
Prediction & Evaluation Duration: 0.10 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_250423/lgb/fold_3/shap_values_fold_3.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/lgb/fold_3/test_data_fold_3.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 0.45 seconds
-- Outer Fold 3 finished. Duration: 766.08 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 250 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.8, 'reg_lambda': 5, 'reg_alpha': 0.5, 'num_leaves': 50, 'n_estimators': 100, 'max_depth': 20, 'learning_rate': 0.01, 'colsample_bytree': 0.6, 'class_weight': None}
Best Inner CV ROC AUC score: 0.9403
Results saved to ../results/cls_250423/lgb/fold_4/best_params.json
Hyperparameter Tuning Duration: 751.20 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/lgb/fold_4/metrics.json
Predictions saved to ../results/cls_250423/lgb/fold_4/predictions.csv
Prediction & Evaluation Duration: 0.18 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_250423/lgb/fold_4/shap_values_fold_4.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/lgb/fold_4/test_data_fold_4.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 0.46 seconds
-- Outer Fold 4 finished. Duration: 751.84 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'subsample': 0.8, 'reg_lambda': 5, 'reg_alpha': 0.5, 'num_leaves': 50, 'n_estimators': 100, 'max_depth': 20, 'learning_rate': 0.01, 'colsample_bytree': 0.6, 'class_weight': None}
Best Inner CV ROC AUC score: 0.8973
Results saved to ../results/cls_250423/lgb/fold_5/best_params.json
Hyperparameter Tuning Duration: 743.34 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/lgb/fold_5/metrics.json
Predictions saved to ../results/cls_250423/lgb/fold_5/predictions.csv
Prediction & Evaluation Duration: 0.06 seconds
Calculating and saving SHAP values...
Calculating SHAP values using TreeExplainer for LightGBM...
SHAP explainer returned a single array. Returning as is.
SHAP values saved to ../results/cls_250423/lgb/fold_5/shap_values_fold_5.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/lgb/fold_5/test_data_fold_5.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 0.33 seconds
-- Outer Fold 5 finished. Duration: 743.76 seconds --

--- Aggregating results for: LightGBM (lgb) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.8697810413885179,
    "accuracy_std": 0.04645375033163182,
    "precision_mean": 0.8274143345265111,
    "precision_std": 0.11469173861532678,
    "recall_mean": 0.7458663976748288,
    "recall_std": 0.14613850333615158,
    "f1_mean": 0.7678954497284435,
    "f1_std": 0.09792175498760247,
    "roc_auc_mean": 0.9300668273678341,
    "roc_auc_std": 0.05492775071498454,
    "pr_auc_mean": 0.8919500288009793,
    "pr_auc_std": 0.07645601742140133,
    "balanced_accuracy_mean": 0.8300846788257523,
    "balanced_accuracy_std": 0.06111552425776765,
    "mcc_mean": 0.6883001332717555,
    "mcc_std": 0.10194996960938721,
    "best_inner_cv_roc_auc_mean": 0.9245842028643402,
    "best_inner_cv_roc_auc_std": 0.019421357102771406
}
Results saved to ../results/cls_250423/lgb/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_250423/lgb ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_250423/lgb...
Found 5 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv', 'shap_values_fold_3.csv', 'shap_values_fold_4.csv', 'shap_values_fold_5.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_250423/lgb...
Found 5 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv', 'test_data_fold_3.csv', 'test_data_fold_4.csv', 'test_data_fold_5.csv']
Found matching SHAP and test data for folds: [1, 2, 3, 4, 5]

Loading Fold 1:
  SHAP file: ../results/cls_250423/lgb/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_250423/lgb/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_250423/lgb/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_250423/lgb/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 3:
  SHAP file: ../results/cls_250423/lgb/fold_3/shap_values_fold_3.csv
  Test data file: ../results/cls_250423/lgb/fold_3/test_data_fold_3.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 4:
  SHAP file: ../results/cls_250423/lgb/fold_4/shap_values_fold_4.csv
  Test data file: ../results/cls_250423/lgb/fold_4/test_data_fold_4.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Loading Fold 5:
  SHAP file: ../results/cls_250423/lgb/fold_5/shap_values_fold_5.csv
  Test data file: ../results/cls_250423/lgb/fold_5/test_data_fold_5.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Combining data from 5 folds...
Successfully combined data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_250423/lgb/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_250423/lgb/global_shap_analysis/lgb_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_250423/lgb/global_shap_analysis/lgb_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: lgb ---
Global SHAP Analysis Duration: 2.04 seconds
Result Aggregation & Global SHAP Duration: 2.37 seconds
Average time per outer fold: 752.69 seconds
--- Nested CV completed for: LightGBM (lgb) ---
Total execution time for model 'lgb': 3765.84 seconds

--- Running Nested CV for: Logistic Regression (logistic) ---
Output directory: ../results/cls_250423/logistic
Using GroupKFold for outer CV with 5 folds based on query IDs.

-- Processing Outer Fold 1/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 650 to 3546
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'model__solver': 'saga', 'model__penalty': 'elasticnet', 'model__max_iter': 2000, 'model__l1_ratio': 0.7000000000000001, 'model__class_weight': 'balanced', 'model__C': 0.005994842503189409}
Best Inner CV ROC AUC score: 0.9379
Results saved to ../results/cls_250423/logistic/fold_1/best_params.json
Hyperparameter Tuning Duration: 19.33 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/logistic/fold_1/metrics.json
Predictions saved to ../results/cls_250423/logistic/fold_1/predictions.csv
Prediction & Evaluation Duration: 0.15 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_250423/logistic/fold_1/shap_values_fold_1.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/logistic/fold_1/test_data_fold_1.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 11.09 seconds
-- Outer Fold 1 finished. Duration: 30.58 seconds --

-- Processing Outer Fold 2/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 150 to 3097
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'model__solver': 'liblinear', 'model__penalty': 'l1', 'model__class_weight': None, 'model__C': 0.005994842503189409}
Best Inner CV ROC AUC score: 0.9670
Results saved to ../results/cls_250423/logistic/fold_2/best_params.json
Hyperparameter Tuning Duration: 17.45 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/logistic/fold_2/metrics.json
Predictions saved to ../results/cls_250423/logistic/fold_2/predictions.csv
Prediction & Evaluation Duration: 0.15 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_250423/logistic/fold_2/shap_values_fold_2.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/logistic/fold_2/test_data_fold_2.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 7.26 seconds
-- Outer Fold 2 finished. Duration: 24.89 seconds --

-- Processing Outer Fold 3/5 --
Train set size: (2898, 63), Test set size: (749, 63)
Test set indices range from 50 to 3147
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'model__solver': 'saga', 'model__penalty': 'l1', 'model__max_iter': 1000, 'model__class_weight': None, 'model__C': 0.005994842503189409}
Best Inner CV ROC AUC score: 0.9503
Results saved to ../results/cls_250423/logistic/fold_3/best_params.json
Hyperparameter Tuning Duration: 21.03 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/logistic/fold_3/metrics.json
Predictions saved to ../results/cls_250423/logistic/fold_3/predictions.csv
Prediction & Evaluation Duration: 0.06 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_250423/logistic/fold_3/shap_values_fold_3.csv (shape: (749, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/logistic/fold_3/test_data_fold_3.csv (shape: (749, 63))
SHAP Calculation & Saving Duration: 6.72 seconds
-- Outer Fold 3 finished. Duration: 27.85 seconds --

-- Processing Outer Fold 4/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 250 to 3646
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'model__solver': 'saga', 'model__penalty': 'elasticnet', 'model__max_iter': 2000, 'model__l1_ratio': 0.5, 'model__class_weight': 'balanced', 'model__C': 0.000774263682681127}
Best Inner CV ROC AUC score: 0.9638
Results saved to ../results/cls_250423/logistic/fold_4/best_params.json
Hyperparameter Tuning Duration: 20.50 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/logistic/fold_4/metrics.json
Predictions saved to ../results/cls_250423/logistic/fold_4/predictions.csv
Prediction & Evaluation Duration: 0.07 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_250423/logistic/fold_4/shap_values_fold_4.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/logistic/fold_4/test_data_fold_4.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 8.54 seconds
-- Outer Fold 4 finished. Duration: 29.12 seconds --

-- Processing Outer Fold 5/5 --
Train set size: (2947, 63), Test set size: (700, 63)
Test set indices range from 0 to 3596
Using GroupKFold for inner CV with 3 folds.
Starting hyperparameter tuning (RandomizedSearchCV)...
Fitting 3 folds for each of 200 candidates, totalling 600 fits
Best Params found: {'model__solver': 'saga', 'model__penalty': 'elasticnet', 'model__max_iter': 2000, 'model__l1_ratio': 0.5, 'model__class_weight': 'balanced', 'model__C': 0.000774263682681127}
Best Inner CV ROC AUC score: 0.9430
Results saved to ../results/cls_250423/logistic/fold_5/best_params.json
Hyperparameter Tuning Duration: 20.30 seconds
Predicting on outer test set...
Calculating performance metrics...
Results saved to ../results/cls_250423/logistic/fold_5/metrics.json
Predictions saved to ../results/cls_250423/logistic/fold_5/predictions.csv
Prediction & Evaluation Duration: 0.12 seconds
Calculating and saving SHAP values...
Calculating SHAP values using LinearExplainer for Logistic Regression...
Scaling X_test data using the pipeline's scaler...
Initializing SHAP LinearExplainer...
Calculating SHAP values...
Returning SHAP values.
SHAP values saved to ../results/cls_250423/logistic/fold_5/shap_values_fold_5.csv (shape: (700, 63))
Test data corresponding to SHAP values saved to ../results/cls_250423/logistic/fold_5/test_data_fold_5.csv (shape: (700, 63))
SHAP Calculation & Saving Duration: 10.44 seconds
-- Outer Fold 5 finished. Duration: 30.87 seconds --

--- Aggregating results for: Logistic Regression (logistic) ---
Average Metrics across folds:
{
    "accuracy_mean": 0.8861575433911882,
    "accuracy_std": 0.050911206896022854,
    "precision_mean": 0.8688771769116235,
    "precision_std": 0.1301631050374992,
    "recall_mean": 0.7581060334028655,
    "recall_std": 0.12473388534384541,
    "f1_mean": 0.7962224552821601,
    "f1_std": 0.08999389959695288,
    "roc_auc_mean": 0.9472117939497977,
    "roc_auc_std": 0.039412304654482616,
    "pr_auc_mean": 0.9325915055520912,
    "pr_auc_std": 0.045702143437062054,
    "balanced_accuracy_mean": 0.8475379391012503,
    "balanced_accuracy_std": 0.06036511539914008,
    "mcc_mean": 0.7282605570010909,
    "mcc_std": 0.11053564946722066,
    "best_inner_cv_roc_auc_mean": 0.952391849878586,
    "best_inner_cv_roc_auc_std": 0.011380358432703136
}
Results saved to ../results/cls_250423/logistic/metrics_summary.json

Running global SHAP analysis...

--- Starting Global SHAP Analysis in: ../results/cls_250423/logistic ---
Searching for 'shap_values_fold_*.csv' in subdirectories of ../results/cls_250423/logistic...
Found 5 SHAP files: ['shap_values_fold_1.csv', 'shap_values_fold_2.csv', 'shap_values_fold_3.csv', 'shap_values_fold_4.csv', 'shap_values_fold_5.csv']
Searching for 'test_data_fold_*.csv' in subdirectories of ../results/cls_250423/logistic...
Found 5 test data files: ['test_data_fold_1.csv', 'test_data_fold_2.csv', 'test_data_fold_3.csv', 'test_data_fold_4.csv', 'test_data_fold_5.csv']
Found matching SHAP and test data for folds: [1, 2, 3, 4, 5]

Loading Fold 1:
  SHAP file: ../results/cls_250423/logistic/fold_1/shap_values_fold_1.csv
  Test data file: ../results/cls_250423/logistic/fold_1/test_data_fold_1.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)
  Established feature names from Fold 1 (63 features).

Loading Fold 2:
  SHAP file: ../results/cls_250423/logistic/fold_2/shap_values_fold_2.csv
  Test data file: ../results/cls_250423/logistic/fold_2/test_data_fold_2.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 3:
  SHAP file: ../results/cls_250423/logistic/fold_3/shap_values_fold_3.csv
  Test data file: ../results/cls_250423/logistic/fold_3/test_data_fold_3.csv
  Loaded SHAP shape: (749, 63)
  Loaded Test Data shape: (749, 63)

Loading Fold 4:
  SHAP file: ../results/cls_250423/logistic/fold_4/shap_values_fold_4.csv
  Test data file: ../results/cls_250423/logistic/fold_4/test_data_fold_4.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Loading Fold 5:
  SHAP file: ../results/cls_250423/logistic/fold_5/shap_values_fold_5.csv
  Test data file: ../results/cls_250423/logistic/fold_5/test_data_fold_5.csv
  Loaded SHAP shape: (700, 63)
  Loaded Test Data shape: (700, 63)

Combining data from 5 folds...
Successfully combined data from 5 folds.
Combined SHAP values shape: (3647, 63)
Combined test data shape: (3647, 63)

Generating global SHAP plots (Top 15 Features) in: ../results/cls_250423/logistic/global_shap_analysis
Global SHAP bar plot (Top 15) saved to: ../results/cls_250423/logistic/global_shap_analysis/logistic_global_shap_bar_top15.png
Global SHAP dot plot (Top 15) saved to: ../results/cls_250423/logistic/global_shap_analysis/logistic_global_shap_beeswarm_top15.png
--- Global SHAP Analysis Finished for: logistic ---
Global SHAP Analysis Duration: 1.42 seconds
Result Aggregation & Global SHAP Duration: 1.49 seconds
Average time per outer fold: 28.66 seconds
--- Nested CV completed for: Logistic Regression (logistic) ---
Total execution time for model 'logistic': 144.83 seconds

--- Overall Training Summary ---
Model comparison summary saved to: ../results/cls_250423/model_comparison_summary.csv
  model_name  ...  best_inner_cv_roc_auc_std
0         rf  ...                   0.018706
1        xgb  ...                   0.020011
2        lgb  ...                   0.019421
3   logistic  ...                   0.011380

[4 rows x 19 columns]
Final Summary Saving Duration: 0.18 seconds

--- Framework Execution Finished ---
Total script execution time: 4520.11 seconds
작업 완료
[INFO] Job completed at: Wed Apr 23 21:04:21 KST 2025
